2025-12-19 10:14:28 | INFO | Logging initialized at: ('D:\\Gritstone.Ebantistrack.EbantisV4.EXE\\Ebantis_setup copy\\Ebantis_setup_2025-12-19.log',)
2025-12-19 10:14:28 | INFO | Running with administrative privileges.
2025-12-19 10:14:28 | INFO | Starting Ebantis installer/uninstaller process...
2025-12-19 10:14:29 | INFO | Starting installation with tenant name: gritstone technologies
2025-12-19 10:14:29 | INFO | Fetching credentials from API: https://ebantistrackapi.metlone.com/api/v1/Connection/GetAllConnections?tenant=gritstone technologies for tenant: gritstone technologies
2025-12-19 10:14:29 | INFO | Connecting to SQLite database at path: C:/ProgramData/EbantisV4\user_collection\Gritlocaladmin\tracking_system.db
2025-12-19 10:14:29 | INFO | API credentials successfully stored in SQLite.
2025-12-19 10:14:29 | INFO | SQLite connection closed.
2025-12-19 10:14:29 | INFO | Credentials successfully decrypted.
2025-12-19 10:14:29 | INFO | MongoDB connection string retrieved successfully.
2025-12-19 10:14:29 | INFO | Fetching tenant unique ID from API: https://qaebantisv4service.thekosmoz.com/api/v1/Tenant/GetTenantByName/gritstone technologies
2025-12-19 10:14:30 | ERROR | API request error while fetching Tenant ID for 'gritstone technologies': Expecting value: line 1 column 1 (char 0)
2025-12-19 10:14:30 | INFO | Tenant name 'None' saved successfully to JSON file: C:/ProgramData/EbantisV4\tenant_info\tenant_details.json
2025-12-19 10:14:30 | INFO | Fetching app version details from API: https://qaebantisv4service.thekosmoz.com/api/v1/AppVersion/GetAppVersionByTenantId/None
2025-12-19 10:14:30 | ERROR | API request error while checking installation for tenant None: Expecting value: line 1 column 1 (char 0)
2025-12-19 10:27:30 | INFO | Logging initialized at: ('D:\\Gritstone.Ebantistrack.EbantisV4.EXE\\Ebantis_setup copy\\Ebantis_setup_2025-12-19.log',)
2025-12-19 10:27:30 | INFO | Running with administrative privileges.
2025-12-19 10:27:31 | INFO | Starting Ebantis installer/uninstaller process...
2025-12-19 10:27:31 | INFO | Starting installation with tenant name: Deloite Technologies
2025-12-19 10:27:31 | INFO | Fetching credentials from API: https://ebantistrackapi.metlone.com/api/v1/Connection/GetAllConnections?tenant=None for tenant: None
2025-12-19 10:27:32 | INFO | Connecting to SQLite database at path: C:/ProgramData/EbantisV4\user_collection\Gritlocaladmin\tracking_system.db
2025-12-19 10:27:32 | INFO | API credentials successfully stored in SQLite.
2025-12-19 10:27:32 | INFO | SQLite connection closed.
2025-12-19 10:27:32 | INFO | Credentials successfully decrypted.
2025-12-19 10:27:32 | INFO | MongoDB connection string retrieved successfully.
2025-12-19 10:27:32 | INFO | Fetching tenant unique ID from API: https://qaebantisv4service.thekosmoz.com/api/v1/Tenant/GetTenantByName/Deloite Technologies
2025-12-19 10:27:32 | INFO | Tenant Unique ID found for 'Deloite Technologies': 1087b659-9eeb-427b-a977-ee3226b0892d
2025-12-19 10:27:32 | INFO | Tenant name '1087b659-9eeb-427b-a977-ee3226b0892d' saved successfully to JSON file: C:/ProgramData/EbantisV4\tenant_info\tenant_details.json
2025-12-19 10:27:32 | INFO | Fetching app version details from API: https://qaebantisv4service.thekosmoz.com/api/v1/AppVersion/GetAppVersionByTenantId/1087b659-9eeb-427b-a977-ee3226b0892d
2025-12-19 10:27:32 | ERROR | API request error while checking installation for tenant 1087b659-9eeb-427b-a977-ee3226b0892d: Expecting value: line 1 column 1 (char 0)
2025-12-19 10:45:13 | INFO | Logging initialized at: ('D:\\Gritstone.Ebantistrack.EbantisV4.EXE\\Ebantis_setup copy\\Ebantis_setup_2025-12-19.log',)
2025-12-19 10:45:13 | INFO | Running with administrative privileges.
2025-12-19 10:45:13 | INFO | Starting Ebantis installer/uninstaller process...
2025-12-19 10:45:14 | INFO | Starting installation with tenant name: Deloite Technologies
2025-12-19 10:45:14 | INFO | Fetching credentials from API: https://ebantistrackapi.metlone.com/api/v1/Connection/GetAllConnections?tenant=None for tenant: None
2025-12-19 10:45:14 | INFO | Connecting to SQLite database at path: C:/ProgramData/EbantisV4\user_collection\Gritlocaladmin\tracking_system.db
2025-12-19 10:45:14 | INFO | API credentials successfully stored in SQLite.
2025-12-19 10:45:14 | INFO | SQLite connection closed.
2025-12-19 10:45:14 | INFO | Credentials successfully decrypted.
2025-12-19 10:45:14 | INFO | MongoDB connection string retrieved successfully.
2025-12-19 10:45:14 | INFO | Fetching tenant unique ID from API: https://qaebantisv4service.thekosmoz.com/api/v1/Tenant/GetTenantByName/Deloite Technologies
2025-12-19 10:45:15 | INFO | Tenant Unique ID found for 'Deloite Technologies': 1087b659-9eeb-427b-a977-ee3226b0892d
2025-12-19 10:45:15 | INFO | Tenant name '1087b659-9eeb-427b-a977-ee3226b0892d' saved successfully to JSON file: C:/ProgramData/EbantisV4\tenant_info\tenant_details.json
2025-12-19 10:45:15 | INFO | Fetching app version details from API: https://qaebantisv4service.thekosmoz.com/api/v1/AppVersion/GetAppVersionByTenantId/1087b659-9eeb-427b-a977-ee3226b0892d
2025-12-19 10:45:15 | INFO | Installation allowed for tenant 1087b659-9eeb-427b-a977-ee3226b0892d (0/200)
2025-12-19 10:45:15 | INFO | Installation allowed. Proceeding to register the agent...
2025-12-19 10:45:15 | INFO | Registering agent at: https://ebantisapiv4.thekosmoz.com/register-agent
2025-12-19 10:45:15 | INFO | Payload being sent: {'machine_id': '4C4C4544-0057-4B10-804E-B7C04F375333', 'hostname': 'GRIT-CLT-LT-254', 'display_name': 'gritlocaladmin', 'email': None, 'upn': '', 'username': 'Gritlocaladmin'}
2025-12-19 10:45:15 | INFO | Register Agent API returned status: 200
2025-12-19 10:45:15 | INFO | Agent registered successfully: {'status': 'ok', 'message': 'Agent registered successfully', 'machine_id': '4C4C4544-0057-4B10-804E-B7C04F375333', 'user_id': '1', 'tenant_id': 0, 'tenant_name': '', 'tenant_unique_id': '', 'company_unique_id': '', 'branch_unique_id': '', 'username': 'Gritlocaladmin', 'user_email': None}
2025-12-19 10:45:15 | INFO | Starting installation...
2025-12-19 10:45:15 | INFO | InstallWorker started.
2025-12-19 10:45:15 | INFO | Existing utils path found: C:/Program Files/EbantisV4\data\EbantisV4\utils. Ending running tasks.
2025-12-19 10:45:15 | INFO | EXE files found to terminate: []
2025-12-19 10:45:17 | INFO | Removed: C:/Program Files/EbantisV4\data\EbantisV4\utils
2025-12-19 10:45:17 | INFO | End_task completed successfully.
2025-12-19 10:45:17 | INFO | Removing update directory: C:/Program Files/EbantisV4\data
2025-12-19 10:45:17 | ERROR | Error removing C:/Program Files/EbantisV4\data: [WinError 32] The process cannot access the file because it is being used by another process: 'C:/Program Files/EbantisV4\\data\\EbantisV4\\EbantisTracker_2025-12-19.log'
2025-12-19 10:45:17 | WARNING | Startup file not found: C:\ProgramData\Microsoft\Windows\Start Menu\Programs\StartUp\ebantis.bat
2025-12-19 10:45:17 | INFO | Previous version removed successfully.
2025-12-19 10:45:17 | INFO | Starting download of main and model packages in parallel.
2025-12-19 10:45:17 | INFO | Connected to SQLite database at: C:/ProgramData/EbantisV4\user_collection\Gritlocaladmin\tracking_system.db
2025-12-19 10:45:17 | INFO | Credentials successfully decoded from database.
2025-12-19 10:45:18 | INFO | Fetching latest version details from MongoDB...
2025-12-19 10:45:19 | INFO | Latest Version_Id retrieved: v4.0.0
2025-12-19 10:45:19 | INFO | Installation data upserted for host: GRIT-CLT-LT-254
2025-12-19 10:45:19 | INFO | Starting main package download from API...
2025-12-19 10:45:19 | INFO | File size from API: 31 bytes
2025-12-19 10:45:23 | INFO | Downloaded main package successfully.
2025-12-19 10:45:23 | INFO | Extracting main package from C:/ProgramData/EbantisV4\Ebantisv4.zip to C:/Program Files/EbantisV4\data...
2025-12-19 10:45:23 | ERROR | Error during robust zip extraction to C:/Program Files/EbantisV4\data: [Errno 13] Permission denied: 'C:\\Program Files\\EbantisV4\\data\\EbantisV4\\EbantisV4.exe'
2025-12-19 10:45:23 | ERROR | Main package download/extraction failed: [Errno 13] Permission denied: 'C:\\Program Files\\EbantisV4\\data\\EbantisV4\\EbantisV4.exe'
2025-12-19 10:45:26 | WARNING | Download failed; skipping cleanup.
2025-12-19 10:45:26 | INFO | Main package download/extraction result: False
2025-12-19 10:45:26 | ERROR | One or more package downloads/extractions failed.
